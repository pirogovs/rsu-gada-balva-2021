parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"xlnG":[function(require,module,exports) {
Function.prototype.bind=Function.prototype.bind||function(n){var t=this;return function(o){o instanceof Array||(o=[o]),t.apply(n,o)}};
},{}],"ikgL":[function(require,module,exports) {
!function(){if(!(void 0===window.Element||"classList"in document.documentElement)){var t,i,n,e=Array.prototype,s=e.push,o=e.splice,r=e.join;c.prototype={add:function(t){this.contains(t)||(s.call(this,t),this.el.className=this.toString())},contains:function(t){return-1!=this.el.className.indexOf(t)},item:function(t){return this[t]||null},remove:function(t){if(this.contains(t)){for(var i=0;i<this.length&&this[i]!=t;i++);o.call(this,i,1),this.el.className=this.toString()}},toString:function(){return r.call(this," ")},toggle:function(t){return this.contains(t)?this.remove(t):this.add(t),this.contains(t)}},window.DOMTokenList=c,t=HTMLElement.prototype,i="classList",n=function(){return new c(this)},Object.defineProperty?Object.defineProperty(t,i,{get:n}):t.__defineGetter__(i,n)}function c(t){this.el=t;for(var i=t.className.replace(/^\s+|\s+$/g,"").split(/\s+/),n=0;n<i.length;n++)s.call(this,i[n])}}();
},{}],"yPYC":[function(require,module,exports) {
!function(){for(var n=0,i=["webkit","moz"],e=0;e<i.length&&!window.requestAnimationFrame;++e)window.requestAnimationFrame=window[i[e]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[i[e]+"CancelAnimationFrame"]||window[i[e]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(i){var e=(new Date).getTime(),a=Math.max(0,16-(e-n)),o=window.setTimeout(function(){i(e+a)},a);return n=e+a,o}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(n){clearTimeout(n)})}();
},{}],"BQcX":[function(require,module,exports) {
"use strict";function t(){this.events={},window.navigator.msPointerEnabled?(this.eventTouchstart="MSPointerDown",this.eventTouchmove="MSPointerMove",this.eventTouchend="MSPointerUp"):(this.eventTouchstart="touchstart",this.eventTouchmove="touchmove",this.eventTouchend="touchend"),this.listen()}Object.defineProperty(exports,"__esModule",{value:!0}),exports.KeyboardInputManager=t,t.prototype.on=function(t,e){this.events[t]||(this.events[t]=[]),this.events[t].push(e)},t.prototype.emit=function(t,e){var n=this.events[t];n&&n.forEach(function(t){t(e)})},t.prototype.listen=function(){var t,e,n=this,i={38:0,39:1,40:2,37:3,75:0,76:1,74:2,72:3,87:0,68:1,83:2,65:3};document.addEventListener("keydown",function(t){var e=t.altKey||t.ctrlKey||t.metaKey||t.shiftKey,o=i[t.which];e||void 0!==o&&(t.preventDefault(),n.emit("move",o)),e||82!==t.which||n.restart.call(n,t)}),this.bindButtonPress(".retry-button",this.restart),this.bindButtonPress(".restart-button",this.restart),this.bindButtonPress(".keep-playing-button",this.keepPlaying);var o=document.getElementsByClassName("game-container")[0];o.addEventListener(this.eventTouchstart,function(n){!window.navigator.msPointerEnabled&&n.touches.length>1||n.targetTouches.length>1||(window.navigator.msPointerEnabled?(t=n.pageX,e=n.pageY):(t=n.touches[0].clientX,e=n.touches[0].clientY),n.preventDefault())}),o.addEventListener(this.eventTouchmove,function(t){t.preventDefault()}),o.addEventListener(this.eventTouchend,function(i){if(!(!window.navigator.msPointerEnabled&&i.touches.length>0||i.targetTouches.length>0)){var o,s;window.navigator.msPointerEnabled?(o=i.pageX,s=i.pageY):(o=i.changedTouches[0].clientX,s=i.changedTouches[0].clientY);var a=o-t,r=Math.abs(a),h=s-e,u=Math.abs(h);Math.max(r,u)>10&&n.emit("move",r>u?a>0?1:3:h>0?2:0)}})},t.prototype.restart=function(t){t.preventDefault(),this.emit("restart")},t.prototype.keepPlaying=function(t){t.preventDefault(),this.emit("keepPlaying")},t.prototype.bindButtonPress=function(t,e){var n=document.querySelector(t);n.addEventListener("click",e.bind(this)),n.addEventListener(this.eventTouchend,e.bind(this))};
},{}],"J31S":[function(require,module,exports) {
"use strict";function e(){this.tileContainer=document.querySelector(".tile-container"),this.scoreContainer=document.querySelector(".score-container"),this.bestContainer=document.querySelector(".best-container"),this.messageContainer=document.querySelector(".game-message"),this.score=0}Object.defineProperty(exports,"__esModule",{value:!0}),exports.HTMLActuator=e,e.prototype.actuate=function(e,t){var o=this;window.requestAnimationFrame(function(){o.clearContainer(o.tileContainer),e.cells.forEach(function(e){e.forEach(function(e){e&&o.addTile(e)})}),o.updateScore(t.score),o.updateBestScore(t.bestScore),t.terminated&&(t.over?o.message(!1):t.won&&o.message(!0))})},e.prototype.continueGame=function(){this.clearMessage()},e.prototype.clearContainer=function(e){for(;e.firstChild;)e.removeChild(e.firstChild)},e.prototype.addTile=function(e){var t=this,o=document.createElement("div"),i=document.createElement("div"),s=e.previousPosition||{x:e.x,y:e.y},n=this.positionClass(s),r=["tile","tile-"+e.value,n];e.value>2048&&r.push("tile-super"),this.applyClasses(o,r),i.classList.add("tile-inner"),e.previousPosition?window.requestAnimationFrame(function(){r[2]=t.positionClass({x:e.x,y:e.y}),t.applyClasses(o,r)}):e.mergedFrom?(r.push("tile-merged"),this.applyClasses(o,r),e.mergedFrom.forEach(function(e){t.addTile(e)})):(r.push("tile-new"),this.applyClasses(o,r)),o.appendChild(i),this.tileContainer.appendChild(o)},e.prototype.applyClasses=function(e,t){e.setAttribute("class",t.join(" "))},e.prototype.normalizePosition=function(e){return{x:e.x+1,y:e.y+1}},e.prototype.positionClass=function(e){return"tile-position-"+(e=this.normalizePosition(e)).x+"-"+e.y},e.prototype.updateScore=function(e){this.clearContainer(this.scoreContainer);var t=e-this.score;if(this.score=e,this.scoreContainer.textContent=this.score,t>0){var o=document.createElement("div");o.classList.add("score-addition"),o.textContent="+"+t,this.scoreContainer.appendChild(o)}},e.prototype.updateBestScore=function(e){this.bestContainer.textContent=e},e.prototype.message=function(e){var t=e?"game-won":"game-over",o=e?"Tu uzvarēji!":"Spēle beigusies!";this.messageContainer.classList.add(t),this.messageContainer.getElementsByTagName("p")[0].textContent=o},e.prototype.clearMessage=function(){this.messageContainer.classList.remove("game-won"),this.messageContainer.classList.remove("game-over")};
},{}],"DYo7":[function(require,module,exports) {
"use strict";function t(){this.bestScoreKey="bestScore",this.gameStateKey="gameState";var t=this.localStorageSupported();this.storage=t?window.localStorage:window.fakeStorage}Object.defineProperty(exports,"__esModule",{value:!0}),exports.LocalStorageManager=t,window.fakeStorage={_data:{},setItem:function(t,e){return this._data[t]=String(e)},getItem:function(t){return this._data.hasOwnProperty(t)?this._data[t]:void 0},removeItem:function(t){return delete this._data[t]},clear:function(){return this._data={}}},t.prototype.localStorageSupported=function(){try{var t=window.localStorage;return t.setItem("test","1"),t.removeItem("test"),!0}catch(e){return!1}},t.prototype.getBestScore=function(){return this.storage.getItem(this.bestScoreKey)||0},t.prototype.setBestScore=function(t){this.storage.setItem(this.bestScoreKey,t)},t.prototype.getGameState=function(){var t=this.storage.getItem(this.gameStateKey);return t?JSON.parse(t):null},t.prototype.setGameState=function(t){this.storage.setItem(this.gameStateKey,JSON.stringify(t))},t.prototype.clearGameState=function(){this.storage.removeItem(this.gameStateKey)};
},{}],"kkbC":[function(require,module,exports) {
"use strict";function t(t,i){this.x=t.x,this.y=t.y,this.value=i||2,this.previousPosition=null,this.mergedFrom=null}Object.defineProperty(exports,"__esModule",{value:!0}),exports.Tile=t,t.prototype.savePosition=function(){this.previousPosition={x:this.x,y:this.y}},t.prototype.updatePosition=function(t){this.x=t.x,this.y=t.y},t.prototype.serialize=function(){return{position:{x:this.x,y:this.y},value:this.value}};
},{}],"mwQg":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Grid=e;var t=require("./tile");function e(t,e){this.size=t,this.cells=e?this.fromState(e):this.empty()}e.prototype.empty=function(){for(var t=[],e=0;e<this.size;e++)for(var i=t[e]=[],l=0;l<this.size;l++)i.push(null);return t},e.prototype.fromState=function(e){for(var i=[],l=0;l<this.size;l++)for(var r=i[l]=[],s=0;s<this.size;s++){var o=e[l][s];r.push(o?new t.Tile(o.position,o.value):null)}return i},e.prototype.randomAvailableCell=function(){var t=this.availableCells();if(t.length)return t[Math.floor(Math.random()*t.length)]},e.prototype.availableCells=function(){var t=[];return this.eachCell(function(e,i,l){l||t.push({x:e,y:i})}),t},e.prototype.eachCell=function(t){for(var e=0;e<this.size;e++)for(var i=0;i<this.size;i++)t(e,i,this.cells[e][i])},e.prototype.cellsAvailable=function(){return!!this.availableCells().length},e.prototype.cellAvailable=function(t){return!this.cellOccupied(t)},e.prototype.cellOccupied=function(t){return!!this.cellContent(t)},e.prototype.cellContent=function(t){return this.withinBounds(t)?this.cells[t.x][t.y]:null},e.prototype.insertTile=function(t){this.cells[t.x][t.y]=t},e.prototype.removeTile=function(t){this.cells[t.x][t.y]=null},e.prototype.withinBounds=function(t){return t.x>=0&&t.x<this.size&&t.y>=0&&t.y<this.size},e.prototype.serialize=function(){for(var t=[],e=0;e<this.size;e++)for(var i=t[e]=[],l=0;l<this.size;l++)i.push(this.cells[e][l]?this.cells[e][l].serialize():null);return{size:this.size,cells:t}};
},{"./tile":"kkbC"}],"NUXH":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.GameManager=i;var e=require("./grid"),t=require("./tile");function i(e,t,i,r){this.size=e,this.inputManager=new t,this.storageManager=new r,this.actuator=new i,this.startTiles=2,this.inputManager.on("move",this.move.bind(this)),this.inputManager.on("restart",this.restart.bind(this)),this.inputManager.on("keepPlaying",this.keepPlaying.bind(this)),this.setup()}i.prototype.restart=function(){this.storageManager.clearGameState(),this.actuator.continueGame(),this.setup()},i.prototype.keepPlaying=function(){this.keepPlaying=!1,this.actuator.continueGame()},i.prototype.isGameTerminated=function(){return this.over||this.won&&!this.keepPlaying},i.prototype.setup=function(){var t=this.storageManager.getGameState();t?(this.grid=new e.Grid(t.grid.size,t.grid.cells),this.score=t.score,this.over=t.over,this.won=t.won,this.keepPlaying=t.keepPlaying):(this.grid=new e.Grid(this.size),this.score=0,this.over=!1,this.won=!1,this.keepPlaying=!1,this.addStartTiles()),this.actuate()},i.prototype.addStartTiles=function(){for(var e=0;e<this.startTiles;e++)this.addRandomTile()},i.prototype.addRandomTile=function(){if(this.grid.cellsAvailable()){var e=Math.random()<.9?2:4,i=new t.Tile(this.grid.randomAvailableCell(),e);this.grid.insertTile(i)}},i.prototype.actuate=function(){this.storageManager.getBestScore()<this.score&&this.storageManager.setBestScore(this.score),this.over?this.storageManager.clearGameState():this.storageManager.setGameState(this.serialize()),this.actuator.actuate(this.grid,{score:this.score,over:this.over,won:this.won,bestScore:this.storageManager.getBestScore(),terminated:this.isGameTerminated()}),this.won&&(this.storageManager.clearGameState(),setTimeout(function(){document.querySelector("body").innerHTML='<iframe src="https://docs.google.com/forms/d/e/1FAIpQLSdQHQwwWjPd-s7FNZi1DOFtrCloXXLqrhBGjEMEmmZi8F9Iuw/viewform?embedded=true" width="100%" height="1499" frameborder="0" marginheight="0" marginwidth="0">Loading…</iframe>'},2e3))},i.prototype.serialize=function(){return{grid:this.grid.serialize(),score:this.score,over:this.over,won:this.won,keepPlaying:this.keepPlaying}},i.prototype.prepareTiles=function(){this.grid.eachCell(function(e,t,i){i&&(i.mergedFrom=null,i.savePosition())})},i.prototype.moveTile=function(e,t){this.grid.cells[e.x][e.y]=null,this.grid.cells[t.x][t.y]=e,e.updatePosition(t)},i.prototype.move=function(e){var i=this;if(!this.isGameTerminated()){var r,s,a=this.getVector(e),o=this.buildTraversals(a),n=!1;this.prepareTiles(),o.x.forEach(function(e){o.y.forEach(function(o){if(r={x:e,y:o},s=i.grid.cellContent(r)){var h=i.findFarthestPosition(r,a),l=i.grid.cellContent(h.next);if(l&&l.value===s.value&&!l.mergedFrom){var u=new t.Tile(h.next,2*s.value);u.mergedFrom=[s,l],i.grid.insertTile(u),i.grid.removeTile(s),s.updatePosition(h.next),i.score+=u.value,32===u.value&&(i.won=!0)}else i.moveTile(s,h.farthest);i.positionsEqual(r,s)||(n=!0)}})}),n&&(this.addRandomTile(),this.movesAvailable()||(this.over=!0),this.actuate())}},i.prototype.getVector=function(e){return{0:{x:0,y:-1},1:{x:1,y:0},2:{x:0,y:1},3:{x:-1,y:0}}[e]},i.prototype.buildTraversals=function(e){for(var t={x:[],y:[]},i=0;i<this.size;i++)t.x.push(i),t.y.push(i);return 1===e.x&&(t.x=t.x.reverse()),1===e.y&&(t.y=t.y.reverse()),t},i.prototype.findFarthestPosition=function(e,t){var i;do{e={x:(i=e).x+t.x,y:i.y+t.y}}while(this.grid.withinBounds(e)&&this.grid.cellAvailable(e));return{farthest:i,next:e}},i.prototype.movesAvailable=function(){return this.grid.cellsAvailable()||this.tileMatchesAvailable()},i.prototype.tileMatchesAvailable=function(){for(var e,t=0;t<this.size;t++)for(var i=0;i<this.size;i++)if(e=this.grid.cellContent({x:t,y:i}))for(var r=0;r<4;r++){var s=this.getVector(r),a={x:t+s.x,y:i+s.y},o=this.grid.cellContent(a);if(o&&o.value===e.value)return!0}return!1},i.prototype.positionsEqual=function(e,t){return e.x===t.x&&e.y===t.y};
},{"./grid":"mwQg","./tile":"kkbC"}],"vP9g":[function(require,module,exports) {
"use strict";require("./bind_polyfill"),require("./classlist_polyfill"),require("./animframe_polyfill");var e=require("./keyboard_input_manager"),r=require("./html_actuator"),a=require("./local_storage_manager"),i=require("./game_manager");window.requestAnimationFrame(function(){new i.GameManager(4,e.KeyboardInputManager,r.HTMLActuator,a.LocalStorageManager)});
},{"./bind_polyfill":"xlnG","./classlist_polyfill":"ikgL","./animframe_polyfill":"yPYC","./keyboard_input_manager":"BQcX","./html_actuator":"J31S","./local_storage_manager":"DYo7","./game_manager":"NUXH"}]},{},["vP9g"], null)
//# sourceMappingURL=application.1205081d.js.map